export class PdfDocumentPropertiesExtractor {
    pdfDateStringRegex = new RegExp('^D:' + // Prefix (required)
        '(\\d{4})' + // Year (required)
        '(\\d{2})?' + // Month (optional)
        '(\\d{2})?' + // Day (optional)
        '(\\d{2})?' + // Hour (optional)
        '(\\d{2})?' + // Minute (optional)
        '(\\d{2})?' + // Second (optional)
        '([Z|+|-])?' + // Universal time relation (optional)
        '(\\d{2})?' + // Offset hour (optional)
        // tslint:disable-next-line: quotemark
        "'?" + // Splitting apostrophe (optional)
        '(\\d{2})?' + // Offset minute (optional)
        // tslint:disable-next-line: quotemark
        "'?" // Trailing apostrophe (optional)
    );
    async getDocumentProperties() {
        const PDFViewerApplication = window.PDFViewerApplication;
        const pdfDocument = PDFViewerApplication.pdfDocument;
        const result = {};
        const md = await pdfDocument.getMetadata();
        const info = md.info;
        result.author = info.Author;
        result.creationDate = this.toDateObject(info.CreationDate);
        result.creator = info.Creator;
        result.keywords = info.Keywords;
        result.linearized = info.IsLinearized;
        result.modificationDate = this.toDateObject(info.ModDate);
        result.pdfFormatVersion = info.PDFFormatVersion;
        result.producer = info.Producer;
        result.subject = info.Subject;
        result.title = info.Title;
        if (md['contentDispositionFilename']) {
            result.fileName = md['contentDispositionFilename'];
        }
        result.maybeFileSize = (await pdfDocument.getDownloadInfo()).length;
        return result;
    }
    /** shamelessly copied from pdf.js */
    toDateObject(input) {
        // Optional fields that don't satisfy the requirements from the regular
        // expression (such as incorrect digit counts or numbers that are out of
        // range) will fall back the defaults from the specification.
        const matches = this.pdfDateStringRegex.exec(input);
        if (!matches) {
            return null;
        }
        // JavaScript's `Date` object expects the month to be between 0 and 11
        // instead of 1 and 12, so we have to correct for that.
        const year = parseInt(matches[1], 10);
        let month = parseInt(matches[2], 10);
        month = month >= 1 && month <= 12 ? month - 1 : 0;
        let day = parseInt(matches[3], 10);
        day = day >= 1 && day <= 31 ? day : 1;
        let hour = parseInt(matches[4], 10);
        hour = hour >= 0 && hour <= 23 ? hour : 0;
        let minute = parseInt(matches[5], 10);
        minute = minute >= 0 && minute <= 59 ? minute : 0;
        let second = parseInt(matches[6], 10);
        second = second >= 0 && second <= 59 ? second : 0;
        const universalTimeRelation = matches[7] || 'Z';
        let offsetHour = parseInt(matches[8], 10);
        offsetHour = offsetHour >= 0 && offsetHour <= 23 ? offsetHour : 0;
        let offsetMinute = parseInt(matches[9], 10) || 0;
        offsetMinute = offsetMinute >= 0 && offsetMinute <= 59 ? offsetMinute : 0;
        // Universal time relation 'Z' means that the local time is equal to the
        // universal time, whereas the relations '+'/'-' indicate that the local
        // time is later respectively earlier than the universal time. Every date
        // is normalized to universal time.
        if (universalTimeRelation === '-') {
            hour += offsetHour;
            minute += offsetMinute;
        }
        else if (universalTimeRelation === '+') {
            hour -= offsetHour;
            minute -= offsetMinute;
        }
        return new Date(Date.UTC(year, month, day, hour, minute, second));
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGRmLWRvY3VtZW50LXByb3BlcnRpZXMtZXh0cmFjdG9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LWV4dGVuZGVkLXBkZi12aWV3ZXIvc3JjL2xpYi9wZGYtZG9jdW1lbnQtcHJvcGVydGllcy1leHRyYWN0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBaUJBLE1BQU0sT0FBTyw4QkFBOEI7SUFDakMsa0JBQWtCLEdBQUcsSUFBSSxNQUFNLENBQ3JDLEtBQUssR0FBRyxvQkFBb0I7UUFDMUIsVUFBVSxHQUFHLGtCQUFrQjtRQUMvQixXQUFXLEdBQUcsbUJBQW1CO1FBQ2pDLFdBQVcsR0FBRyxpQkFBaUI7UUFDL0IsV0FBVyxHQUFHLGtCQUFrQjtRQUNoQyxXQUFXLEdBQUcsb0JBQW9CO1FBQ2xDLFdBQVcsR0FBRyxvQkFBb0I7UUFDbEMsWUFBWSxHQUFHLHFDQUFxQztRQUNwRCxXQUFXLEdBQUcseUJBQXlCO1FBQ3ZDLHNDQUFzQztRQUN0QyxJQUFJLEdBQUcsa0NBQWtDO1FBQ3pDLFdBQVcsR0FBRywyQkFBMkI7UUFDekMsc0NBQXNDO1FBQ3RDLElBQUksQ0FBQyxpQ0FBaUM7S0FDekMsQ0FBQztJQUVLLEtBQUssQ0FBQyxxQkFBcUI7UUFDaEMsTUFBTSxvQkFBb0IsR0FBMkIsTUFBYyxDQUFDLG9CQUFvQixDQUFDO1FBQ3pGLE1BQU0sV0FBVyxHQUFHLG9CQUFvQixDQUFDLFdBQVcsQ0FBQztRQUVyRCxNQUFNLE1BQU0sR0FBUSxFQUFFLENBQUM7UUFDdkIsTUFBTSxFQUFFLEdBQUcsTUFBTSxXQUFXLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDM0MsTUFBTSxJQUFJLEdBQUcsRUFBRSxDQUFDLElBQXNCLENBQUM7UUFFdkMsTUFBTSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDO1FBQzVCLE1BQU0sQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDM0QsTUFBTSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDO1FBQzlCLE1BQU0sQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQztRQUNoQyxNQUFNLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUM7UUFDdEMsTUFBTSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQzFELE1BQU0sQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUM7UUFDaEQsTUFBTSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDO1FBQ2hDLE1BQU0sQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQztRQUM5QixNQUFNLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUM7UUFDMUIsSUFBSSxFQUFFLENBQUMsNEJBQTRCLENBQUMsRUFBRTtZQUNwQyxNQUFNLENBQUMsUUFBUSxHQUFHLEVBQUUsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO1NBQ3BEO1FBQ0QsTUFBTSxDQUFDLGFBQWEsR0FBRyxDQUFDLE1BQU0sV0FBVyxDQUFDLGVBQWUsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDO1FBQ3BFLE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7SUFFRCxxQ0FBcUM7SUFDN0IsWUFBWSxDQUFDLEtBQW1CO1FBQ3RDLHVFQUF1RTtRQUN2RSx3RUFBd0U7UUFDeEUsNkRBQTZEO1FBQzdELE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDcEQsSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNaLE9BQU8sSUFBSSxDQUFDO1NBQ2I7UUFFRCxzRUFBc0U7UUFDdEUsdURBQXVEO1FBQ3ZELE1BQU0sSUFBSSxHQUFHLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDdEMsSUFBSSxLQUFLLEdBQUcsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUNyQyxLQUFLLEdBQUcsS0FBSyxJQUFJLENBQUMsSUFBSSxLQUFLLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEQsSUFBSSxHQUFHLEdBQUcsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUNuQyxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN0QyxJQUFJLElBQUksR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBQ3BDLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxJQUFJLElBQUksSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzFDLElBQUksTUFBTSxHQUFHLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDdEMsTUFBTSxHQUFHLE1BQU0sSUFBSSxDQUFDLElBQUksTUFBTSxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEQsSUFBSSxNQUFNLEdBQUcsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUN0QyxNQUFNLEdBQUcsTUFBTSxJQUFJLENBQUMsSUFBSSxNQUFNLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsRCxNQUFNLHFCQUFxQixHQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUMsSUFBSSxHQUFHLENBQUM7UUFDaEQsSUFBSSxVQUFVLEdBQUcsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUMxQyxVQUFVLEdBQUcsVUFBVSxJQUFJLENBQUMsSUFBSSxVQUFVLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsRSxJQUFJLFlBQVksR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNqRCxZQUFZLEdBQUcsWUFBWSxJQUFJLENBQUMsSUFBSSxZQUFZLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUUxRSx3RUFBd0U7UUFDeEUsd0VBQXdFO1FBQ3hFLHlFQUF5RTtRQUN6RSxtQ0FBbUM7UUFDbkMsSUFBSSxxQkFBcUIsS0FBSyxHQUFHLEVBQUU7WUFDakMsSUFBSSxJQUFJLFVBQVUsQ0FBQztZQUNuQixNQUFNLElBQUksWUFBWSxDQUFDO1NBQ3hCO2FBQU0sSUFBSSxxQkFBcUIsS0FBSyxHQUFHLEVBQUU7WUFDeEMsSUFBSSxJQUFJLFVBQVUsQ0FBQztZQUNuQixNQUFNLElBQUksWUFBWSxDQUFDO1NBQ3hCO1FBRUQsT0FBTyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUNwRSxDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJUERGVmlld2VyQXBwbGljYXRpb24gfSBmcm9tICcuL29wdGlvbnMvcGRmLXZpZXdlci1hcHBsaWNhdGlvbic7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFBkZkRvY3VtZW50SW5mbyB7XHJcbiAgYXV0aG9yPzogc3RyaW5nO1xyXG4gIGNyZWF0aW9uRGF0ZT86IERhdGU7XHJcbiAgY3JlYXRvcj86IHN0cmluZztcclxuXHJcbiAga2V5d29yZHM/OiBzdHJpbmc7XHJcbiAgbGluZWFyaXplZD86IGJvb2xlYW47XHJcbiAgbWF5YmVGaWxlU2l6ZT86IHN0cmluZztcclxuICBtb2RpZmljYXRpb25EYXRlPzogRGF0ZTtcclxuICBwZGZGb3JtYXRWZXJzaW9uPzogc3RyaW5nO1xyXG4gIHByb2R1Y2VyPzogc3RyaW5nO1xyXG4gIHN1YmplY3Q/OiBzdHJpbmc7XHJcbiAgdGl0bGU/OiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBQZGZEb2N1bWVudFByb3BlcnRpZXNFeHRyYWN0b3Ige1xyXG4gIHByaXZhdGUgcGRmRGF0ZVN0cmluZ1JlZ2V4ID0gbmV3IFJlZ0V4cChcclxuICAgICdeRDonICsgLy8gUHJlZml4IChyZXF1aXJlZClcclxuICAgICAgJyhcXFxcZHs0fSknICsgLy8gWWVhciAocmVxdWlyZWQpXHJcbiAgICAgICcoXFxcXGR7Mn0pPycgKyAvLyBNb250aCAob3B0aW9uYWwpXHJcbiAgICAgICcoXFxcXGR7Mn0pPycgKyAvLyBEYXkgKG9wdGlvbmFsKVxyXG4gICAgICAnKFxcXFxkezJ9KT8nICsgLy8gSG91ciAob3B0aW9uYWwpXHJcbiAgICAgICcoXFxcXGR7Mn0pPycgKyAvLyBNaW51dGUgKG9wdGlvbmFsKVxyXG4gICAgICAnKFxcXFxkezJ9KT8nICsgLy8gU2Vjb25kIChvcHRpb25hbClcclxuICAgICAgJyhbWnwrfC1dKT8nICsgLy8gVW5pdmVyc2FsIHRpbWUgcmVsYXRpb24gKG9wdGlvbmFsKVxyXG4gICAgICAnKFxcXFxkezJ9KT8nICsgLy8gT2Zmc2V0IGhvdXIgKG9wdGlvbmFsKVxyXG4gICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IHF1b3RlbWFya1xyXG4gICAgICBcIic/XCIgKyAvLyBTcGxpdHRpbmcgYXBvc3Ryb3BoZSAob3B0aW9uYWwpXHJcbiAgICAgICcoXFxcXGR7Mn0pPycgKyAvLyBPZmZzZXQgbWludXRlIChvcHRpb25hbClcclxuICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBxdW90ZW1hcmtcclxuICAgICAgXCInP1wiIC8vIFRyYWlsaW5nIGFwb3N0cm9waGUgKG9wdGlvbmFsKVxyXG4gICk7XHJcblxyXG4gIHB1YmxpYyBhc3luYyBnZXREb2N1bWVudFByb3BlcnRpZXMoKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIGNvbnN0IFBERlZpZXdlckFwcGxpY2F0aW9uOiBJUERGVmlld2VyQXBwbGljYXRpb24gPSAod2luZG93IGFzIGFueSkuUERGVmlld2VyQXBwbGljYXRpb247XHJcbiAgICBjb25zdCBwZGZEb2N1bWVudCA9IFBERlZpZXdlckFwcGxpY2F0aW9uLnBkZkRvY3VtZW50O1xyXG5cclxuICAgIGNvbnN0IHJlc3VsdDogYW55ID0ge307XHJcbiAgICBjb25zdCBtZCA9IGF3YWl0IHBkZkRvY3VtZW50LmdldE1ldGFkYXRhKCk7XHJcbiAgICBjb25zdCBpbmZvID0gbWQuaW5mbyBhcyB1bmtub3duIGFzIGFueTtcclxuXHJcbiAgICByZXN1bHQuYXV0aG9yID0gaW5mby5BdXRob3I7XHJcbiAgICByZXN1bHQuY3JlYXRpb25EYXRlID0gdGhpcy50b0RhdGVPYmplY3QoaW5mby5DcmVhdGlvbkRhdGUpO1xyXG4gICAgcmVzdWx0LmNyZWF0b3IgPSBpbmZvLkNyZWF0b3I7XHJcbiAgICByZXN1bHQua2V5d29yZHMgPSBpbmZvLktleXdvcmRzO1xyXG4gICAgcmVzdWx0LmxpbmVhcml6ZWQgPSBpbmZvLklzTGluZWFyaXplZDtcclxuICAgIHJlc3VsdC5tb2RpZmljYXRpb25EYXRlID0gdGhpcy50b0RhdGVPYmplY3QoaW5mby5Nb2REYXRlKTtcclxuICAgIHJlc3VsdC5wZGZGb3JtYXRWZXJzaW9uID0gaW5mby5QREZGb3JtYXRWZXJzaW9uO1xyXG4gICAgcmVzdWx0LnByb2R1Y2VyID0gaW5mby5Qcm9kdWNlcjtcclxuICAgIHJlc3VsdC5zdWJqZWN0ID0gaW5mby5TdWJqZWN0O1xyXG4gICAgcmVzdWx0LnRpdGxlID0gaW5mby5UaXRsZTtcclxuICAgIGlmIChtZFsnY29udGVudERpc3Bvc2l0aW9uRmlsZW5hbWUnXSkge1xyXG4gICAgICByZXN1bHQuZmlsZU5hbWUgPSBtZFsnY29udGVudERpc3Bvc2l0aW9uRmlsZW5hbWUnXTtcclxuICAgIH1cclxuICAgIHJlc3VsdC5tYXliZUZpbGVTaXplID0gKGF3YWl0IHBkZkRvY3VtZW50LmdldERvd25sb2FkSW5mbygpKS5sZW5ndGg7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxuXHJcbiAgLyoqIHNoYW1lbGVzc2x5IGNvcGllZCBmcm9tIHBkZi5qcyAqL1xyXG4gIHByaXZhdGUgdG9EYXRlT2JqZWN0KGlucHV0OiBzdHJpbmcgfCBhbnkpOiBEYXRlIHwgbnVsbCB7XHJcbiAgICAvLyBPcHRpb25hbCBmaWVsZHMgdGhhdCBkb24ndCBzYXRpc2Z5IHRoZSByZXF1aXJlbWVudHMgZnJvbSB0aGUgcmVndWxhclxyXG4gICAgLy8gZXhwcmVzc2lvbiAoc3VjaCBhcyBpbmNvcnJlY3QgZGlnaXQgY291bnRzIG9yIG51bWJlcnMgdGhhdCBhcmUgb3V0IG9mXHJcbiAgICAvLyByYW5nZSkgd2lsbCBmYWxsIGJhY2sgdGhlIGRlZmF1bHRzIGZyb20gdGhlIHNwZWNpZmljYXRpb24uXHJcbiAgICBjb25zdCBtYXRjaGVzID0gdGhpcy5wZGZEYXRlU3RyaW5nUmVnZXguZXhlYyhpbnB1dCk7XHJcbiAgICBpZiAoIW1hdGNoZXMpIHtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSmF2YVNjcmlwdCdzIGBEYXRlYCBvYmplY3QgZXhwZWN0cyB0aGUgbW9udGggdG8gYmUgYmV0d2VlbiAwIGFuZCAxMVxyXG4gICAgLy8gaW5zdGVhZCBvZiAxIGFuZCAxMiwgc28gd2UgaGF2ZSB0byBjb3JyZWN0IGZvciB0aGF0LlxyXG4gICAgY29uc3QgeWVhciA9IHBhcnNlSW50KG1hdGNoZXNbMV0sIDEwKTtcclxuICAgIGxldCBtb250aCA9IHBhcnNlSW50KG1hdGNoZXNbMl0sIDEwKTtcclxuICAgIG1vbnRoID0gbW9udGggPj0gMSAmJiBtb250aCA8PSAxMiA/IG1vbnRoIC0gMSA6IDA7XHJcbiAgICBsZXQgZGF5ID0gcGFyc2VJbnQobWF0Y2hlc1szXSwgMTApO1xyXG4gICAgZGF5ID0gZGF5ID49IDEgJiYgZGF5IDw9IDMxID8gZGF5IDogMTtcclxuICAgIGxldCBob3VyID0gcGFyc2VJbnQobWF0Y2hlc1s0XSwgMTApO1xyXG4gICAgaG91ciA9IGhvdXIgPj0gMCAmJiBob3VyIDw9IDIzID8gaG91ciA6IDA7XHJcbiAgICBsZXQgbWludXRlID0gcGFyc2VJbnQobWF0Y2hlc1s1XSwgMTApO1xyXG4gICAgbWludXRlID0gbWludXRlID49IDAgJiYgbWludXRlIDw9IDU5ID8gbWludXRlIDogMDtcclxuICAgIGxldCBzZWNvbmQgPSBwYXJzZUludChtYXRjaGVzWzZdLCAxMCk7XHJcbiAgICBzZWNvbmQgPSBzZWNvbmQgPj0gMCAmJiBzZWNvbmQgPD0gNTkgPyBzZWNvbmQgOiAwO1xyXG4gICAgY29uc3QgdW5pdmVyc2FsVGltZVJlbGF0aW9uID0gbWF0Y2hlc1s3XSB8fCAnWic7XHJcbiAgICBsZXQgb2Zmc2V0SG91ciA9IHBhcnNlSW50KG1hdGNoZXNbOF0sIDEwKTtcclxuICAgIG9mZnNldEhvdXIgPSBvZmZzZXRIb3VyID49IDAgJiYgb2Zmc2V0SG91ciA8PSAyMyA/IG9mZnNldEhvdXIgOiAwO1xyXG4gICAgbGV0IG9mZnNldE1pbnV0ZSA9IHBhcnNlSW50KG1hdGNoZXNbOV0sIDEwKSB8fCAwO1xyXG4gICAgb2Zmc2V0TWludXRlID0gb2Zmc2V0TWludXRlID49IDAgJiYgb2Zmc2V0TWludXRlIDw9IDU5ID8gb2Zmc2V0TWludXRlIDogMDtcclxuXHJcbiAgICAvLyBVbml2ZXJzYWwgdGltZSByZWxhdGlvbiAnWicgbWVhbnMgdGhhdCB0aGUgbG9jYWwgdGltZSBpcyBlcXVhbCB0byB0aGVcclxuICAgIC8vIHVuaXZlcnNhbCB0aW1lLCB3aGVyZWFzIHRoZSByZWxhdGlvbnMgJysnLyctJyBpbmRpY2F0ZSB0aGF0IHRoZSBsb2NhbFxyXG4gICAgLy8gdGltZSBpcyBsYXRlciByZXNwZWN0aXZlbHkgZWFybGllciB0aGFuIHRoZSB1bml2ZXJzYWwgdGltZS4gRXZlcnkgZGF0ZVxyXG4gICAgLy8gaXMgbm9ybWFsaXplZCB0byB1bml2ZXJzYWwgdGltZS5cclxuICAgIGlmICh1bml2ZXJzYWxUaW1lUmVsYXRpb24gPT09ICctJykge1xyXG4gICAgICBob3VyICs9IG9mZnNldEhvdXI7XHJcbiAgICAgIG1pbnV0ZSArPSBvZmZzZXRNaW51dGU7XHJcbiAgICB9IGVsc2UgaWYgKHVuaXZlcnNhbFRpbWVSZWxhdGlvbiA9PT0gJysnKSB7XHJcbiAgICAgIGhvdXIgLT0gb2Zmc2V0SG91cjtcclxuICAgICAgbWludXRlIC09IG9mZnNldE1pbnV0ZTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbmV3IERhdGUoRGF0ZS5VVEMoeWVhciwgbW9udGgsIGRheSwgaG91ciwgbWludXRlLCBzZWNvbmQpKTtcclxuICB9XHJcbn1cclxuIl19